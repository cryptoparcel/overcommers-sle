{% extends "base.html" %}
{% block content %}
<section class="section">
  <div class="container page">
    <h1>Apply</h1>
    <p class="muted">This form is intentionally short. If you’re accepted, we’ll confirm details over a call.</p>

    <form method="post" class="form" novalidate>
      {{ form.hidden_tag() }}
      <div class="grid grid--form">
        <div class="field">
          <label>{{ form.full_name.label }}</label>
          {{ form.full_name(class_="input") }}
          {% for e in form.full_name.errors %}<div class="error">{{ e }}</div>{% endfor %}
        </div>
        <div class="field">
          <label>{{ form.email.label }}</label>
          {{ form.email(class_="input") }}
          {% for e in form.email.errors %}<div class="error">{{ e }}</div>{% endfor %}
        </div>
        <div class="field grid__span2">
          <label>{{ form.phone.label }}</label>
          {{ form.phone(class_="input") }}
          {% for e in form.phone.errors %}<div class="error">{{ e }}</div>{% endfor %}
        </div>
        <div class="field grid__span2">
          <label>{{ form.message.label }}</label>
          {{ form.message(class_="textarea", rows="7") }}
          {% for e in form.message.errors %}<div class="error">{{ e }}</div>{% endfor %}
        </div>
      </div>

      {{ form.recaptcha_token(id="recaptcha_token") }}
      {% for e in form.recaptcha_token.errors %}<div class="error">{{ e }}</div>{% endfor %}

      <div class="form__actions">
        <button class="btn btn--primary" type="submit" data-track="submit_apply">Submit application</button>
        <a class="btn btn--ghost" href="{{ url_for('public.contact') }}">Questions?</a>
      </div>
    </form>
  </div>
</section>

{% if config.get('RECAPTCHA_SITE_KEY') %}
<script>
document.addEventListener('DOMContentLoaded', function(){
  if (typeof grecaptcha === 'undefined') return;
  grecaptcha.ready(function() {
    grecaptcha.execute('{{ config.get("RECAPTCHA_SITE_KEY") }}', {action: 'apply'}).then(function(token) {
      var el = document.getElementById('recaptcha_token');
      if (el) el.value = token;
    });
  });
});
</script>
{% endif %}
{% endblock %}
